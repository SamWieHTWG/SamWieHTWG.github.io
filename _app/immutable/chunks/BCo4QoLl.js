import"./CWj6FrbW.js";import{r as K,u as j,G as X,o as t,aq as v,B as G,x as z,y as Z,F as pe,D as he,z as W,A as H,v as se,C as N,w as ve,an as xe,m as be,ap as $e,aK as Se,k as _e,ab as we,ah as Te,Y as ye}from"./95-tTr9P.js";import{s as ee,a as te}from"./B-cTme2W.js";import{p as V,r as Be,g as Fe,a as Ce,b as Ee,T as Ae,I as Le,L as Re,c as Pe,B as oe,C as Ie,S as De,d as ae,V as Y,e as ie,f as Ve,h as Oe,M as ke,i as ze,j as Me,k as Ue,l as ge,m as Ge,n as Ne,o as We,q as He,s as qe,t as je,u as Ye,G as Ke,v as Xe,w as Ze,x as Je,y as Qe,z as et,A as tt,D as rt,E as at,H as le}from"./CBk6878D.js";import{t as T}from"./Bw086dH9.js";import"./uriF5xkT.js";import"./2x_3pxqx.js";import{b as Q}from"./BOFSTtfN.js";import{S as re,a as q,e as me,i as fe,c as nt}from"./989zpzj5.js";import{p as ne,i as st}from"./DIGU72wg.js";import{b as ot}from"./DuOoQ1F7.js";import{i as it}from"./Cg3LIffo.js";var lt=j("<!> <!>",1);function Lt(x,p){K(p,!0);const[b,m]=ee();let d=v(()=>te(V,"$parameterStore",b));function i(r){var s;const a=(r.detail||((s=r.target)==null?void 0:s.value))==="rund";V.updateField("isRound",a)}const g=v(()=>T("bridgeBearing.bearingShape")),u=v(()=>t(d).isRound?"rund":"rechteckig");re(x,{get labelText(){return t(g)},get selected(){return t(u)},light:!0,$$events:{change:i},children:(r,e)=>{var a=lt(),s=X(a);const o=v(()=>T("bridgeBearing.rectangular"));q(s,{value:"rechteckig",get text(){return t(o)}});var l=G(s,2);const c=v(()=>T("bridgeBearing.round"));q(l,{value:"rund",get text(){return t(c)}}),z(r,a)},$$slots:{default:!0}}),Z(),m()}function Rt(x,p){K(p,!0);const[b,m]=ee();let d=v(()=>te(V,"$parameterStore",b)),i=v(Fe),g=v(()=>Be.map(o=>o.diameter)),u=v(()=>t(d).isRound?t(g).findIndex(o=>o===t(d).d):t(i).findIndex(o=>o.length===t(d).a&&o.width===t(d).b)),r=v(()=>t(d).isRound?t(g).map((o,l)=>({value:l,label:`${o} mm`})):t(i).map((o,l)=>({value:l,label:`${o.length} mm x ${o.width} mm`})));function e(o){var c;const l=parseInt(((c=o.target)==null?void 0:c.value)||o.detail);if(t(d).isRound){const n=t(g)[l];n&&V.updateField("d",n)}else{const n=t(i)[l];n&&(V.updateField("a",n.length),V.updateField("b",n.width))}}const a=v(()=>t(d).isRound?T("bridgeBearing.dimensionsDiameter"):T("bridgeBearing.dimensionsLengthWidth")),s=v(()=>t(u).toString());re(x,{get labelText(){return t(a)},get selected(){return t(s)},light:!0,$$events:{change:e},children:(o,l)=>{var c=pe(),n=X(c);me(n,17,()=>t(r),fe,($,_)=>{const y=v(()=>t(_).value.toString());q($,{get value(){return t(y)},get text(){return t(_).label}})}),z(o,c)},$$slots:{default:!0}}),Z(),m()}function Pt(x,p){K(p,!0);const[b,m]=ee();let d=v(()=>te(V,"$parameterStore",b)),i=v(()=>t(d).isRound?Ce(t(d).d).map(e=>({value:`${e.n}-${e.t_1}`,label:`${T("bridgeBearing.layerCount")} ${e.n}, ${T("bridgeBearing.layerHeight")} ${e.t_1}mm`,n:e.n,t_1:e.t_1})):Ee(t(d).a,t(d).b).map(e=>({value:`${e.n}-${e.t_1}`,label:`${T("bridgeBearing.layerCount")} ${e.n}, ${T("bridgeBearing.layerHeight")} ${e.t_1}mm`,n:e.n,t_1:e.t_1})));he(()=>{const e=`${t(d).n}-${t(d).t_1}`;if(!t(i).some(s=>s.value===e)&&t(i).length>0){const s=t(i)[0];V.update(o=>({...o,n:s.n,t_1:s.t_1}))}});function g(e){var n;const a=((n=e.target)==null?void 0:n.value)||e.detail,[s,o]=a.split("-"),l=parseInt(s),c=parseFloat(o);V.update($=>({...$,n:l,t_1:c}))}const u=v(()=>T("bridgeBearing.elastomerLayers")),r=v(()=>`${t(d).n}-${t(d).t_1}`);re(x,{get labelText(){return t(u)},get selected(){return t(r)},light:!0,$$events:{change:g},children:(e,a)=>{var s=pe(),o=X(s);me(o,17,()=>t(i),fe,(l,c)=>{const n=v(()=>t(c).value.toString());q(l,{get value(){return t(n)},get text(){return t(c).label}})}),z(e,s)},$$slots:{default:!0}}),Z(),m()}var ct=j('<span slot="tooltipText"> <br/> <br/> <br/> <br/> <br/> <br/> </span>'),dt=j("<!> <!>",1),ut=j('<div class="select-with-tooltip svelte-17kum7t"><div class="label-container svelte-17kum7t"><span class="label-text svelte-17kum7t"> </span> <!></div> <div style="margin-top: calc(-1 * var(--cds-spacing-03));"></div> <!></div>');function It(x,p){K(p,!0);const[b,m]=ee();let d=v(()=>te(V,"$parameterStore",b));function i(l){var $;const n=(l.detail||(($=l.target)==null?void 0:$.value))==="Typ C"?"C":"B";V.updateField("l_typ",n)}var g=ut(),u=W(g),r=W(u),e=W(r,!0);H(r);var a=G(r,2);Ae(a,{get icon(){return Le},$$slots:{tooltipText:(l,c)=>{var n=ct(),$=W(n,!0),_=G($,4),y=G(_,4),F=G(y,4);H(n),se((C,S,L,R)=>{N($,C),N(_,` ${S??""}`),N(y,` ${L??""}`),N(F,` ${R??""}`)},[()=>T("bridgeBearing.typeBTooltip"),()=>T("bridgeBearing.typeCTooltip"),()=>T("bridgeBearing.typeCRequired"),()=>T("bridgeBearing.typeB_DBRestriction")]),z(l,n)}}}),H(u);var s=G(u,4);const o=v(()=>t(d).l_typ==="C"?"Typ C":"Typ B");re(s,{labelText:"",get selected(){return t(o)},light:!0,$$events:{change:i},children:(l,c)=>{var n=dt(),$=X(n);const _=v(()=>T("bridgeBearing.typeB"));q($,{value:"Typ B",get text(){return t(_)}});var y=G($,2);const F=v(()=>T("bridgeBearing.typeC"));q(y,{value:"Typ C",get text(){return t(F)}}),z(l,n)},$$slots:{default:!0}}),H(g),se(l=>N(e,l),[()=>T("bridgeBearing.bearingType")]),z(x,g),Z(),m()}class pt extends Re{constructor(p){super(p)}load(p,b,m,B){const d=this,i=new Pe(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(p,function(g){try{b(d.parse(g))}catch(u){B?B(u):console.error(u),d.manager.itemError(p)}},m,B)}parse(p){function b(r){const e=new DataView(r),a=32/8*3+32/8*3*3+16/8,s=e.getUint32(80,!0);if(80+32/8+s*a===e.byteLength)return!0;const l=[115,111,108,105,100];for(let c=0;c<5;c++)if(m(l,e,c))return!1;return!0}function m(r,e,a){for(let s=0,o=r.length;s<o;s++)if(r[s]!==e.getUint8(a+s))return!1;return!0}function B(r){const e=new DataView(r),a=e.getUint32(80,!0);let s,o,l,c=!1,n,$,_,y,F;for(let w=0;w<70;w++)e.getUint32(w,!1)==1129270351&&e.getUint8(w+4)==82&&e.getUint8(w+5)==61&&(c=!0,n=new Float32Array(a*3*3),$=e.getUint8(w+6)/255,_=e.getUint8(w+7)/255,y=e.getUint8(w+8)/255,F=e.getUint8(w+9)/255);const C=84,S=12*4+2,L=new oe,R=new Float32Array(a*3*3),P=new Float32Array(a*3*3),I=new Ie;for(let w=0;w<a;w++){const k=C+w*S,f=e.getFloat32(k,!0),E=e.getFloat32(k+4,!0),D=e.getFloat32(k+8,!0);if(c){const h=e.getUint16(k+48,!0);(h&32768)===0?(s=(h&31)/31,o=(h>>5&31)/31,l=(h>>10&31)/31):(s=$,o=_,l=y)}for(let h=1;h<=3;h++){const M=k+h*12,A=w*3*3+(h-1)*3;R[A]=e.getFloat32(M,!0),R[A+1]=e.getFloat32(M+4,!0),R[A+2]=e.getFloat32(M+8,!0),P[A]=f,P[A+1]=E,P[A+2]=D,c&&(I.setRGB(s,o,l,De),n[A]=I.r,n[A+1]=I.g,n[A+2]=I.b)}}return L.setAttribute("position",new ae(R,3)),L.setAttribute("normal",new ae(P,3)),c&&(L.setAttribute("color",new ae(n,3)),L.hasColors=!0,L.alpha=F),L}function d(r){const e=new oe,a=/solid([\s\S]*?)endsolid/g,s=/facet([\s\S]*?)endfacet/g,o=/solid\s(.+)/;let l=0;const c=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,n=new RegExp("vertex"+c+c+c,"g"),$=new RegExp("normal"+c+c+c,"g"),_=[],y=[],F=[],C=new Y;let S,L=0,R=0,P=0;for(;(S=a.exec(r))!==null;){R=P;const I=S[0],w=(S=o.exec(I))!==null?S[1]:"";for(F.push(w);(S=s.exec(I))!==null;){let E=0,D=0;const h=S[0];for(;(S=$.exec(h))!==null;)C.x=parseFloat(S[1]),C.y=parseFloat(S[2]),C.z=parseFloat(S[3]),D++;for(;(S=n.exec(h))!==null;)_.push(parseFloat(S[1]),parseFloat(S[2]),parseFloat(S[3])),y.push(C.x,C.y,C.z),E++,P++;D!==1&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+l),E!==3&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+l),l++}const k=R,f=P-R;e.userData.groupNames=F,e.addGroup(k,f,L),L++}return e.setAttribute("position",new ie(_,3)),e.setAttribute("normal",new ie(y,3)),e}function i(r){return typeof r!="string"?new TextDecoder().decode(r):r}function g(r){if(typeof r=="string"){const e=new Uint8Array(r.length);for(let a=0;a<r.length;a++)e[a]=r.charCodeAt(a)&255;return e.buffer||e}else return r}const u=g(p);return b(u)?B(u):d(i(p))}}function gt(x){Ve(x,-20)}function mt(x){Oe(x,{x:0,y:500,z:0})}function ft(x,p="/Widerlager_klein.stl",b,m,B,d=0){new pt().load(p,g=>{g.computeBoundingBox(),g.computeVertexNormals();const u=g.boundingBox,r=new Y;u.getSize(r);const e=new ke({color:ze,specular:1118481,shininess:30}),a=new Me(g,e);g.computeBoundingBox();const s=new Y,o=new Y;g.boundingBox.getCenter(s),g.boundingBox.getSize(o),g.translate(-s.x,-s.y,-s.z),a.scale.setScalar(1),a.position.set(0,d,0),a.rotation.x=-Math.PI/2,a.castShadow=!0,a.receiveShadow=!0,x.add(a),b&&b(a)},()=>{},g=>{console.error("Error loading STL file:",g)})}let ce=[];function de(x){ce.forEach(p=>{x.remove(p),p.geometry.dispose(),p.material instanceof Ue&&p.material.dispose()}),ce=[]}function ht(){const{subscribe:x,set:p,update:b}=ve({renderer:null,camera:null,controls:null,scene:null,reloadTrigger:0});return{subscribe:x,setScene:m=>{b(B=>({...B,...m}))},reset:()=>{b(m=>({renderer:null,camera:null,controls:null,scene:null,reloadTrigger:m.reloadTrigger}))},reload:()=>{b(m=>({...m,reloadTrigger:m.reloadTrigger+1}))},captureScreenshot:async(m=!1)=>new Promise((B,d)=>{const i={renderer:null,camera:null,controls:null,scene:null,reloadTrigger:0};if(x(r=>{i.renderer=r.renderer,i.camera=r.camera,i.controls=r.controls,i.scene=r.scene,i.reloadTrigger=r.reloadTrigger})(),!i.renderer||!i.camera||!i.scene){d(new Error("Scene not initialized"));return}const u=()=>{if(!i.renderer||!i.camera||!i.scene){d(new Error("Scene not initialized"));return}i.renderer.render(i.scene,i.camera);const r=i.renderer.domElement.toDataURL("image/png");B(r)};m?(ge(),setTimeout(u,1200)):u()})}}const ue=ht();var vt=j('<!> <div class="top-view-button-container svelte-51mmbc"><!></div>',1),xt=j('<div id="container" class="svelte-51mmbc"><!></div>');function Dt(x,p){K(p,!1);let b=ne(p,"parameters",8,void 0),m=ne(p,"autoRotate",8,!1),B=ne(p,"showTooltip",8,!0);const d=[.3,.6,0],i=new Y(3.033053660420776,2.3737696385820284,-.9540866817375618),g=-.15;let u=be(),r,e,a,s,o,l,c,n,$,_,y,F,C;function S(){return et(tt)}function L(f){return f.isRound?f.diameter>350?`${Q}/Widerlager_groß.stl`:`${Q}/Widerlager_klein.stl`:f.breiteElastomer>300?`${Q}/Widerlager_groß.stl`:`${Q}/Widerlager_klein.stl`}function R(f){const E=L(f);if(E===$)return;n&&(r.remove(n),n.geometry.dispose(),Array.isArray(n.material)?n.material.forEach(h=>h.dispose()):n.material.dispose(),n=void 0),$=E;const D=E.includes("klein")?g:0;ft(r,E,h=>{n=h},void 0,void 0,D)}function P(f){if(!o||!l){console.warn("CreateElastomer or elastomerGroup not initialized");return}l.clear(),o.updateElastomer(f,d).forEach(D=>{l.add(D)}),de(r),R(f)}xe(async()=>{r=Ge(),a=Ne(t(u)),gt(r),mt(r),e=We(35),e.position.copy(i),s=He(e,a,d),ue.setScene({renderer:a,camera:e,controls:s,scene:r}),_=qe(a,e,s),y=je(t(u),s,m()),F=Ye(t(u)),o=new Xe(r,e),l=new Ke,r.add(l);const f=b()||S();o.createElastomer(f,d).forEach(O=>{l.add(O)}),R(f);const h=1e3/30;let M=0;const A=O=>{C=requestAnimationFrame(A);const U=O-M;U<h||(M=O-U%h,Ze(O,e,s),Je(s),a.render(r,e))};if(A(0),le(P),await $e(),t(u)&&t(u)instanceof Element){let O=!1;c=new ResizeObserver(()=>{t(u)&&a&&e&&!O&&(O=!0,requestAnimationFrame(()=>{if(t(u)&&a&&e){const U=t(u).clientWidth,J=t(u).clientHeight;a.setSize(U,J),e.aspect=U/J,e.updateProjectionMatrix()}O=!1}))}),c.observe(t(u))}}),Se(()=>{ue.reset(),C!==void 0&&cancelAnimationFrame(C),a&&Qe(a),_==null||_(),y==null||y(),F==null||F(),de(r),n&&(r.remove(n),n.geometry.dispose(),Array.isArray(n.material)?n.material.forEach(f=>f.dispose()):n.material.dispose(),n=void 0),a==null||a.dispose(),le(()=>{}),c==null||c.disconnect()}),it();var I=xt(),w=W(I);{var k=f=>{var E=vt(),D=X(E);rt(D,{});var h=G(D,2),M=W(h);at(M,{size:"small",kind:"secondary",$$events:{click:()=>ge()},children:(A,O)=>{we();var U=Te();se(J=>N(U,J),[()=>T("bridgeBearing.scene.topView")],ye),z(A,U)},$$slots:{default:!0}}),H(h),z(f,E)};st(w,f=>{B()&&f(k)})}return H(I),ot(I,f=>_e(u,f),()=>t(u)),z(x,I),nt(p,"updateElastomer",P),Z({updateElastomer:P})}export{Lt as B,Dt as T,Rt as a,Pt as b,It as c,ue as s};
