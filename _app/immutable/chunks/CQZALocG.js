const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DsaJKJDC.js","./BdaeSs1J.js","./Cbwcjcxs.js"])))=>i.map(i=>d[i]);
import"./CWj6FrbW.js";import"./CD9zgkgP.js";import{v as Xe,h as oe,e as le,aQ as Ze,b3 as We,c as ce,aY as $e,b4 as qe,b5 as Ye,b6 as fe,P as Ke,b7 as Qe,aL as k,w as je,r as ze,ao as Je,k as C,m as X,ap as et,aq as tt,u as Ce,G as ue,F as st,x as te,B as nt,o as I,y as Ne,l as Re,ah as at,aj as rt,aK as it,z as ot,A as lt}from"./Cbwcjcxs.js";import{i as Oe}from"./B3cmOGOu.js";import{p as j,i as ct}from"./D0QL8IJR.js";import{a as ft,s as ut}from"./D0AMHdtW.js";import{t as de}from"./DplPnht8.js";import"./D-ympBPG.js";import"./CDdnL9Ui.js";import{L as dt,N as ht,V as S,f as mt,h as pt,G as U,B as N,c as Ve,R as W,S as ne,O as z,P as Ge,e as A,Q as _t,U as gt,W as bt,X as wt,Y as vt,Z as St,_ as se,$ as R,a0 as Z,i as he,a1 as B,a2 as me,a3 as Y,a4 as pe,a5 as yt,a6 as Tt,a7 as xt,a8 as At,a9 as Lt,aa as It,ab as Mt,ac as Et,k as Ft,l as Pt,m as jt,n as zt,u as Ct,y as Nt}from"./WouXOMNi.js";import{b as Rt}from"./DnG1IrqR.js";import{_ as Ot}from"./Dp1pzeXC.js";function Vt(o,t,e=!1,n=!1,s=!1){var a=o,l="";Xe(()=>{var c=Ze;if(l===(l=t()??"")){oe&&le();return}if(c.nodes_start!==null&&(We(c.nodes_start,c.nodes_end),c.nodes_start=c.nodes_end=null),l!==""){if(oe){ce.data;for(var u=le(),f=u;u!==null&&(u.nodeType!==8||u.data!=="");)f=u,u=$e(u);if(u===null)throw qe(),Ye;fe(ce,f),a=Ke(u);return}var i=l+"";e?i=`<svg>${i}</svg>`:n&&(i=`<math>${i}</math>`);var r=Qe(i);if((e||n)&&(r=k(r)),fe(k(r),r.lastChild),e||n)for(;k(r);)a.before(k(r));else a.before(r)}})}const K={is_voll:1,is_streifen:0,is_punkt:0,f_eigen:8,h:.5,b:4,t:5,g_a:2,n_gleis:1,is_vollbahn:1,is_regionalbahn:0,is_stadtbahn:0,is_strassenbahn:0,is_user_defined:0,q_v:156,n_streifen:3,b_streifen:.3,n_punkt:2,a_punkt:.1,s_punkt:1,betriebslastenImEndzustandAbschaetzen:!1};function _e(o){return o.b<6&&o.n_gleis===2?{...o,n_gleis:1}:o}function Gt(){const{subscribe:o,set:t,update:e}=je(K),n={subscribe:o,set:s=>{const a=_e(s);t(a),Q(a)},update:s=>{e(a=>{const l=s(a),c=_e(l);return Q(c),c})},reset:()=>{t(K),Q(K)},updateField:(s,a)=>{n.update(l=>({...l,[s]:a}))}};return n}const $=Gt();function Q(o){Ot(()=>import("./DsaJKJDC.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(t=>{t.calculate(o)})}var Dt=Ce("<!> <!>",1);function Ls(o,t){ze(t,!1);const[e,n]=ut(),s=()=>ft($,"$massSpringParameterStore",e);let a=j(t,"field",8),l=j(t,"label",8),c=j(t,"helperText",8,""),u=j(t,"step",8,.1),f=j(t,"disabled",8,!1),i=j(t,"min",8,void 0),r=j(t,"max",8,void 0),d=X(),h=X(!1),_=X(""),m=null;function g(v){let M=v,w=!1,y="";i()!==void 0&&v<i()?(M=i(),w=!0,y=`${de("validation.minValueLabel")}: ${i()}${c()?" "+c():""}`):r()!==void 0&&v>r()&&(M=r(),w=!0,y=`${de("validation.maxValueLabel")}: ${r()}${c()?" "+c():""}`),w&&(C(h,!0),C(_,y),m&&clearTimeout(m),m=setTimeout(()=>{C(h,!1),C(_,"")},3e3)),$.updateField(a(),M)}Je(()=>(s(),et(a())),()=>{C(d,s()[a()])}),tt(),Oe();var b=Dt(),p=ue(b);dt(p,{children:(v,M)=>{var w=st(),y=ue(w);Vt(y,l),te(v,w)},$$slots:{default:!0}});var T=nt(p,2);ht(T,{size:"sm",get step(){return u()},get helperText(){return c()},get disabled(){return f()},get min(){return i()},get max(){return r()},light:!0,get invalid(){return I(h)},get invalidText(){return I(_)},get value(){return I(d)},set value(v){C(d,v)},$$events:{change:()=>g(I(d))},$$legacy:!0}),te(o,b),Ne(),n()}const Is={F_EIGEN_MIN:.1,F_EIGEN_MAX:100,F_EIGEN_STEP:.5,H_MIN:.2,H_MAX:1.5,H_STEP:.05,B_MIN:2,B_MAX:8,B_STEP:.1,T_MIN:1,T_MAX:20,T_STEP:1,G_A_MIN:0,G_A_MAX:100,G_A_STEP:.1,Q_V_MIN:0,Q_V_MAX:300,Q_V_STEP:1,B_STREIFEN_MIN:.1,B_STREIFEN_MAX:1,B_STREIFEN_STEP:.05,A_PUNKT_MIN:.02,A_PUNKT_MAX:.5,A_PUNKT_STEP:.01,S_PUNKT_MIN:.4,S_PUNKT_MAX:2,S_PUNKT_STEP:.1};function Ut(o,t,e){if(!o||!t)return;const n=new S;n.subVectors(t.target,o.position),n.normalize();const a=o.position.distanceTo(t.target)*(1-1/e),l=n.clone().multiplyScalar(a);o.position.add(l),t.update()}function kt(o){return()=>{}}function Bt(o,t,e){const n=s=>{s.preventDefault();const a=s.deltaY>0?.95:1.05;Ut(t,e,a)};return o.domElement.addEventListener("wheel",n,{passive:!1}),()=>{o.domElement.removeEventListener("wheel",n)}}function Ht(o){mt(o,-10)}function Xt(o){return pt(o,{x:0,y:500,z:500})}const x=10,De=.05,P=.6,Zt=.3;function ge(o,t,e,n=!1){const s=Wt(o,t,e,n),a=qt(o,t,e,n);return{supportPlate:s,carryPlate:a}}function be(o,t){t&&(we(o,t.supportPlate),we(o,t.carryPlate))}function Wt(o,t,e,n=!1){const s=new U,a=t.b*(1+De),l=Zt,c=x,u=new N(a,l,c),i=new Ve().load("/texture/concrete1.jpg");i.wrapS=W,i.wrapT=W,i.repeat.set(1,1),i.colorSpace=ne;const r=new z({map:i,color:Ge,shininess:100,flatShading:!0,transparent:!1}),d=new A(u,r);d.castShadow=!0,d.receiveShadow=!0,d.position.set(e[0],e[1]-l/2,e[2]+c/2),s.add(d);const h=t.h+l+.1,_=l,m=c,g=c*(1-P),b=new N(_,h,m),p=new N(_,h,g),T=new A(p,r);T.castShadow=!0,T.receiveShadow=!0,T.position.set(e[0]+a/2+_/2,e[1]-l+h/2,e[2]+c*P+1/2*g),s.add(T);const v=new A(b,r);return v.castShadow=!0,v.receiveShadow=!0,v.position.set(e[0]-a/2-_/2,e[1]-l+h/2,e[2]+c/2),s.add(v),o.add(s),s}function $t(o){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e.fillStyle="red",e.beginPath(),e.arc(32,32,28,0,Math.PI*2),e.fill(),e.fillStyle="white",e.font="bold 36px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(o,32,32);const n=new _t(t),s=new gt({map:n}),a=new bt(s);return a.scale.set(.08,.08,1),a}function qt(o,t,e,n=!1){const s=new U,a=t.b,l=t.h,c=x*(1-P),u=new N(a,l,c),i=new Ve().load("/texture/concrete1.jpg");i.wrapS=W,i.wrapT=W,i.repeat.set(1,1),i.colorSpace=ne;const r=new z({map:i,color:Ge,shininess:100,flatShading:!0,transparent:!1}),d=new A(u,r);d.castShadow=!0,d.receiveShadow=!0;const h=t.t/100;return d.position.set(e[0],e[1]+h+l/2,e[2]+P*x+c/2),s.add(d),n&&[{pos:new S(e[0]-a/2,e[1]+.1,e[2]),label:"C0"},{pos:new S(e[0]+a/2,e[1]+.1,e[2]),label:"C1"},{pos:new S(e[0]+a/2,e[1]+.1,e[2]+c),label:"C2"},{pos:new S(e[0]-a/2,e[1]+.1,e[2]+c),label:"C3"}].forEach(({pos:m,label:g})=>{const b=$t(g);b.position.copy(m),s.add(b)}),o.add(s),s}function we(o,t){t&&(t.traverse(e=>{e instanceof A&&(e.geometry.dispose(),Array.isArray(e.material)?e.material.forEach(n=>n.dispose()):e.material.dispose())}),o.remove(t))}const O=.05;function ve(o,t,e,n=!1){const s=new U;return t.is_voll===1?Yt(o,s,t,e):t.is_streifen===1?Kt(o,s,t,e):t.is_punkt===1&&Jt(o,s,t,e),o.add(s),{elastomer:s}}function Se(o,t){!t||!t.elastomer||(t.elastomer.traverse(e=>{e instanceof A&&(e.geometry.dispose(),Array.isArray(e.material)?e.material.forEach(n=>n.dispose()):e.material.dispose())}),o.remove(t.elastomer))}function Yt(o,t,e,n,s){const a=e.b*(1+De),l=e.t/100,c=x*(1-O),u=new N(a,l,c),f=new z({color:3355443,shininess:50,flatShading:!0,transparent:!1}),i=new A(u,f);i.castShadow=!0,i.receiveShadow=!0,i.position.set(n[0],n[1]+l/2,n[2]+O*x+c/2),t.add(i)}const ye=.6;function Ue(o,t,e,n){const s=e-1+2*ye,a=t/s,l=o-t/2,c=a*(ye+(n-1));return l+c}function Kt(o,t,e,n,s){const a=e.n_streifen;if(a<1)return;const l=e.b_streifen,c=e.t/100,u=x*(1-O),f=e.b,i=new z({color:3355443,shininess:50,flatShading:!0,transparent:!1});for(let r=1;r<=a;r++){const d=Ue(n[0],f,a,r),h=Qt(i,l,c,u,d,n);t.add(h)}}function Qt(o,t,e,n,s,a){const l=new N(t,e,n),c=new A(l,o);return c.castShadow=!0,c.receiveShadow=!0,c.position.set(s,a[1]+e/2,a[2]+O*x+n/2),c}function Jt(o,t,e,n,s){const a=e.n_punkt;if(a<1)return;const l=Math.sqrt(e.a_punkt),c=e.t/100,u=e.b,f=O*x,i=x*(1-O),r=e.s_punkt,d=new z({color:3355443,shininess:50,flatShading:!0,transparent:!1});for(let h=1;h<=a;h++){const _=Ue(n[0],u,a,h);let m=0;for(;m+l/2<=i;){const g=n[2]+f+m+l/2,b=new N(l,c,l),p=new A(b,d);if(p.castShadow=!0,p.receiveShadow=!0,p.position.set(_,n[1]+c/2,g),t.add(p),m+=r,r<=0)break}}}const es=/^[og]\s*(.+)?/,ts=/^mtllib /,ss=/^usemtl /,ns=/^usemap /,Te=/\s+/,xe=new S,J=new S,Ae=new S,Le=new S,F=new S,H=new St;function as(){const o={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,e){if(this.object&&this.object.fromDeclaration===!1){this.object.name=t,this.object.fromDeclaration=e!==!1;return}const n=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:e!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(s,a){const l=this._finalize(!1);l&&(l.inherited||l.groupCount<=0)&&this.materials.splice(l.index,1);const c={index:this.materials.length,name:s||"",mtllib:Array.isArray(a)&&a.length>0?a[a.length-1]:"",smooth:l!==void 0?l.smooth:this.smooth,groupStart:l!==void 0?l.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(u){const f={index:typeof u=="number"?u:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return f.clone=this.clone.bind(f),f}};return this.materials.push(c),c},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(s){const a=this.currentMaterial();if(a&&a.groupEnd===-1&&(a.groupEnd=this.geometry.vertices.length/3,a.groupCount=a.groupEnd-a.groupStart,a.inherited=!1),s&&this.materials.length>1)for(let l=this.materials.length-1;l>=0;l--)this.materials[l].groupCount<=0&&this.materials.splice(l,1);return s&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),a}},n&&n.name&&typeof n.clone=="function"){const s=n.clone(0);s.inherited=!0,this.object.materials.push(s)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(t,e){const n=parseInt(t,10);return(n>=0?n-1:n+e/3)*3},parseNormalIndex:function(t,e){const n=parseInt(t,10);return(n>=0?n-1:n+e/3)*3},parseUVIndex:function(t,e){const n=parseInt(t,10);return(n>=0?n-1:n+e/2)*2},addVertex:function(t,e,n){const s=this.vertices,a=this.object.geometry.vertices;a.push(s[t+0],s[t+1],s[t+2]),a.push(s[e+0],s[e+1],s[e+2]),a.push(s[n+0],s[n+1],s[n+2])},addVertexPoint:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,n){const s=this.normals,a=this.object.geometry.normals;a.push(s[t+0],s[t+1],s[t+2]),a.push(s[e+0],s[e+1],s[e+2]),a.push(s[n+0],s[n+1],s[n+2])},addFaceNormal:function(t,e,n){const s=this.vertices,a=this.object.geometry.normals;xe.fromArray(s,t),J.fromArray(s,e),Ae.fromArray(s,n),F.subVectors(Ae,J),Le.subVectors(xe,J),F.cross(Le),F.normalize(),a.push(F.x,F.y,F.z),a.push(F.x,F.y,F.z),a.push(F.x,F.y,F.z)},addColor:function(t,e,n){const s=this.colors,a=this.object.geometry.colors;s[t]!==void 0&&a.push(s[t+0],s[t+1],s[t+2]),s[e]!==void 0&&a.push(s[e+0],s[e+1],s[e+2]),s[n]!==void 0&&a.push(s[n+0],s[n+1],s[n+2])},addUV:function(t,e,n){const s=this.uvs,a=this.object.geometry.uvs;a.push(s[t+0],s[t+1]),a.push(s[e+0],s[e+1]),a.push(s[n+0],s[n+1])},addDefaultUV:function(){const t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){const e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])},addFace:function(t,e,n,s,a,l,c,u,f){const i=this.vertices.length;let r=this.parseVertexIndex(t,i),d=this.parseVertexIndex(e,i),h=this.parseVertexIndex(n,i);if(this.addVertex(r,d,h),this.addColor(r,d,h),c!==void 0&&c!==""){const _=this.normals.length;r=this.parseNormalIndex(c,_),d=this.parseNormalIndex(u,_),h=this.parseNormalIndex(f,_),this.addNormal(r,d,h)}else this.addFaceNormal(r,d,h);if(s!==void 0&&s!==""){const _=this.uvs.length;r=this.parseUVIndex(s,_),d=this.parseUVIndex(a,_),h=this.parseUVIndex(l,_),this.addUV(r,d,h),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";const e=this.vertices.length;for(let n=0,s=t.length;n<s;n++){const a=this.parseVertexIndex(t[n],e);this.addVertexPoint(a),this.addColor(a)}},addLineGeometry:function(t,e){this.object.geometry.type="Line";const n=this.vertices.length,s=this.uvs.length;for(let a=0,l=t.length;a<l;a++)this.addVertexLine(this.parseVertexIndex(t[a],n));for(let a=0,l=e.length;a<l;a++)this.addUVLine(this.parseUVIndex(e[a],s))}};return o.startObject("",!1),o}class rs extends wt{constructor(t){super(t),this.materials=null}load(t,e,n,s){const a=this,l=new vt(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(t,function(c){try{e(a.parse(c))}catch(u){s?s(u):console.error(u),a.manager.itemError(t)}},n,s)}setMaterials(t){return this.materials=t,this}parse(t){const e=new as;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const n=t.split(`
`);let s=[];for(let c=0,u=n.length;c<u;c++){const f=n[c].trimStart();if(f.length===0)continue;const i=f.charAt(0);if(i!=="#")if(i==="v"){const r=f.split(Te);switch(r[0]){case"v":e.vertices.push(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3])),r.length>=7?(H.setRGB(parseFloat(r[4]),parseFloat(r[5]),parseFloat(r[6]),ne),e.colors.push(H.r,H.g,H.b)):e.colors.push(void 0,void 0,void 0);break;case"vn":e.normals.push(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3]));break;case"vt":e.uvs.push(parseFloat(r[1]),parseFloat(r[2]));break}}else if(i==="f"){const d=f.slice(1).trim().split(Te),h=[];for(let m=0,g=d.length;m<g;m++){const b=d[m];if(b.length>0){const p=b.split("/");h.push(p)}}const _=h[0];for(let m=1,g=h.length-1;m<g;m++){const b=h[m],p=h[m+1];e.addFace(_[0],b[0],p[0],_[1],b[1],p[1],_[2],b[2],p[2])}}else if(i==="l"){const r=f.substring(1).trim().split(" ");let d=[];const h=[];if(f.indexOf("/")===-1)d=r;else for(let _=0,m=r.length;_<m;_++){const g=r[_].split("/");g[0]!==""&&d.push(g[0]),g[1]!==""&&h.push(g[1])}e.addLineGeometry(d,h)}else if(i==="p"){const d=f.slice(1).trim().split(" ");e.addPointGeometry(d)}else if((s=es.exec(f))!==null){const r=(" "+s[0].slice(1).trim()).slice(1);e.startObject(r)}else if(ss.test(f))e.object.startMaterial(f.substring(7).trim(),e.materialLibraries);else if(ts.test(f))e.materialLibraries.push(f.substring(7).trim());else if(ns.test(f))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(i==="s"){if(s=f.split(" "),s.length>1){const d=s[1].trim().toLowerCase();e.object.smooth=d!=="0"&&d!=="off"}else e.object.smooth=!0;const r=e.object.currentMaterial();r&&(r.smooth=e.object.smooth)}else{if(f==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+f+'"')}}e.finalize();const a=new U;if(a.materialLibraries=[].concat(e.materialLibraries),!(e.objects.length===1&&e.objects[0].geometry.vertices.length===0)===!0)for(let c=0,u=e.objects.length;c<u;c++){const f=e.objects[c],i=f.geometry,r=f.materials,d=i.type==="Line",h=i.type==="Points";let _=!1;if(i.vertices.length===0)continue;const m=new se;m.setAttribute("position",new R(i.vertices,3)),i.normals.length>0&&m.setAttribute("normal",new R(i.normals,3)),i.colors.length>0&&(_=!0,m.setAttribute("color",new R(i.colors,3))),i.hasUVIndices===!0&&m.setAttribute("uv",new R(i.uvs,2));const g=[];for(let p=0,T=r.length;p<T;p++){const v=r[p],M=v.name+"_"+v.smooth+"_"+_;let w=e.materials[M];if(this.materials!==null){if(w=this.materials.create(v.name),d&&w&&!(w instanceof Z)){const y=new Z;he.prototype.copy.call(y,w),y.color.copy(w.color),w=y}else if(h&&w&&!(w instanceof B)){const y=new B({size:10,sizeAttenuation:!1});he.prototype.copy.call(y,w),y.color.copy(w.color),y.map=w.map,w=y}}w===void 0&&(d?w=new Z:h?w=new B({size:1,sizeAttenuation:!1}):w=new z,w.name=v.name,w.flatShading=!v.smooth,w.vertexColors=_,e.materials[M]=w),g.push(w)}let b;if(g.length>1){for(let p=0,T=r.length;p<T;p++){const v=r[p];m.addGroup(v.groupStart,v.groupCount,p)}d?b=new me(m,g):h?b=new Y(m,g):b=new A(m,g)}else d?b=new me(m,g[0]):h?b=new Y(m,g[0]):b=new A(m,g[0]);b.name=f.name,a.add(b)}else if(e.vertices.length>0){const c=new B({size:1,sizeAttenuation:!1}),u=new se;u.setAttribute("position",new R(e.vertices,3)),e.colors.length>0&&e.colors[0]!==void 0&&(u.setAttribute("color",new R(e.colors,3)),c.vertexColors=!0);const f=new Y(u,c);a.add(f)}return a}}const ee=1.55,is=.01,os=-2,Ie=.6+2.3/2;async function Me(o,t,e,n=!1){const s=new U,a=new rs;return new Promise((l,c)=>{a.load("/rails.obj",u=>{const f=x*(1-P),i=t.t/100,r=e[1]+i+t.h+is,d=e[2]+P*x+f/2+os;let h;t.n_gleis===2?h=e[0]-t.b/2+Ie+ee:h=e[0]+ee,u.position.set(h,r,d);const _=e[2]+P*x,m=new pe(new S(0,0,1),-_),g=e[2]+P*x+f,b=new pe(new S(0,0,-1),g);if(u.traverse(p=>{if(p instanceof A){const T=new z({color:3355443,shininess:80,specular:4473924,clippingPlanes:[m,b],clipShadows:!0});p.material=T,p.castShadow=!0,p.receiveShadow=!0}}),s.add(u),t.n_gleis===2){const p=u.clone(),T=e[0]+t.b/2-Ie+ee;p.position.set(T,r,d),p.traverse(v=>{if(v instanceof A){const M=new z({color:3355443,shininess:80,specular:4473924,clippingPlanes:[m,b],clipShadows:!0});v.material=M,v.castShadow=!0,v.receiveShadow=!0}}),s.add(p)}o.add(s),l({rails:s})},u=>{console.log(u.loaded/u.total*100+"% loaded")},u=>{console.error("Error loading rails.obj:",u),c(u)})})}function Ee(o,t){!t||!t.rails||(t.rails.traverse(e=>{e instanceof A&&(e.geometry.dispose(),Array.isArray(e.material)?e.material.forEach(n=>n.dispose()):e.material.dispose())}),o.remove(t.rails))}let D=[];const ls=Et*20;function cs(o,t,e,n,s,a=.05){xt(o,t,e,n,s,a,D)}function ke(o){D=Tt(o,D)}async function fs(o,t,e,n,s){try{const a=await At(),l=Lt(s,a,ls);It(l);const c=Mt(16711680),u=new A(l,c),f=new S(e[0]-t[0],0,e[2]-t[2]).normalize(),i=new S(-f.z,0,f.x),r=(t[0]+e[0])/2+i.x*n,d=(t[2]+e[2])/2+i.z*n;u.position.set(r,t[1]+.001,d),u.rotation.x=-Math.PI/2;const h=Math.atan2(f.z,f.x)+Math.PI;u.rotation.z=h,o.add(u),D.push(u)}catch(a){console.error("Failed to load font for 3D text:",a)}}async function Fe(o,t){ke(o);const e=Re($),n=new Z({color:16711680,linewidth:30}),s=.25,a=e.b,l=t[2]+P*x,c=t[1]+e.h,u=new S(t[0]-a/2,c,l-s),f=new S(t[0]+a/2,c,l-s),i=new se().setFromPoints([u,f]),r=new yt(i,n);o.add(r),D.push(r);const d=new S().subVectors(f,u).normalize();cs(o,u,f,d,n,.2),await fs(o,[u.x,u.y,u.z],[f.x,f.y,f.z],-.25,`b = ${e.b} m`)}function us(){const{subscribe:o,set:t,update:e}=je(null);return{subscribe:o,set:t,update:e,saveState:(n,s)=>{t({position:n,target:s})},clear:()=>t(null)}}const Pe=us();var ds=Ce('<div class="scene-container svelte-7vnivq"><!></div>');function Ms(o,t){ze(t,!1),j(t,"autoRotate",8,!1);let e=j(t,"showTooltip",8,!0),n;const s=[0,2,0],a=P*x/2,l=new S(s[0],s[1],s[2]+a),c=10,u=new S(s[0]+c,s[1]+c,s[2]-c);let f=X(),i,r,d,h,_,m,g,b,p,T,v,M,w;at(async()=>{i=Ft(),d=Pt(I(f)),Ht(i),m=Xt(i),r=jt(35);const L=Re(Pe);L?r.position.set(L.position.x,L.position.y,L.position.z):r.position.copy(u),w=$.subscribe(async E=>{n=E,i&&g!==void 0&&(g&&be(i,g),b&&Se(i,b),g=ge(i,n,s,!1),b=ve(i,n,s,!1),p&&Ee(i,p),p=await Me(i,n,s,!1),await Fe(i,s))});let q;L?q=[L.target.x,L.target.y,L.target.z]:q=[l.x,l.y,l.z],h=zt(r,d,q),T=Bt(d,r,h),v=kt(I(f)),g=ge(i,n,s,!1),b=ve(i,n,s,!1),Me(i,n,s,!1).then(E=>{p=E}).catch(E=>{console.error("Failed to load rails:",E)}),Fe(i,s);const ae=1e3/30;let re=0;const ie=E=>{M=requestAnimationFrame(ie);const V=E-re;if(!(V<ae)){if(re=E-V%ae,Ct(h),m&&r){const G=new S(0,500,500);G.applyQuaternion(r.quaternion),m.position.copy(r.position).add(G),h&&h.target&&(m.target.position.copy(h.target),m.target.updateMatrixWorld())}d.render(i,r)}};if(ie(0),await rt(),I(f)&&I(f)instanceof Element){let E=!1;_=new ResizeObserver(()=>{I(f)&&d&&r&&!E&&(E=!0,requestAnimationFrame(()=>{if(I(f)&&d&&r){const V=I(f).clientWidth,G=I(f).clientHeight;r.aspect=V/G,r.updateProjectionMatrix(),d.setSize(V,G)}E=!1}))}),_.observe(I(f))}}),it(()=>{r&&h&&h.target&&Pe.saveState({x:r.position.x,y:r.position.y,z:r.position.z},{x:h.target.x,y:h.target.y,z:h.target.z}),M!==void 0&&cancelAnimationFrame(M),T&&T(),v&&v(),w&&w(),_&&_.disconnect(),h&&h.dispose(),d&&d.dispose(),g&&i&&be(i,g),b&&i&&Se(i,b),p&&i&&Ee(i,p),i&&ke(i)}),Oe();var y=ds(),Be=ot(y);{var He=L=>{Nt(L,{rightOffset:0})};ct(Be,L=>{e()&&L(He)})}lt(y),Rt(y,L=>C(f,L),()=>I(f)),te(o,y),Ne()}export{Is as I,Ms as M,Ls as P,$ as m,Q as p};
